remotes::install_github("grantmcdermott/ritest")
library(tidyverse)
library(janitor)
library(haven)
library(RStata)
library(miceadds)
library(ritest)

# PART 1: Primaries (2000, 2002, 2004)
# 2-candidate race (N=11) 
# 11 * 2 = 22
cd1_dem_2002 <- read_dta("Replication/NH2002,2002,2004Primaries/2-candidate races/cd1 dem 2002.dta")
cd1_dem_2002_1 <- lm(clark ~ clarord01 + totvoter, data = cd1_dem_2002)
ritest::ritest(cd1_dem_2002_1, 'clarord01', reps=1e4, seed=1234)
cd1_dem_2002_2 <- lm(dean ~ deanord01 + totvoter, data = cd1_dem_2002)
ritest(cd1_dem_2002_2, 'deanord01', reps=1e4, seed=1234)

cd1_rep_2004 <- read_dta("Replication/NH2002,2002,2004Primaries/2-candidate races/cd1 rep 2004.dta")
cd1_rep_2004_1 <- lm(bevill ~ beviord01 + totvoter, data = cd1_rep_2004)
ritest(cd1_rep_2004_1, 'beviord01', reps=1e4, seed=1234)
cd1_rep_2004_2 <- lm(bradley ~ bradord01 + totvoter, data = cd1_rep_2004)
ritest(cd1_rep_2004_2, 'bradord01', reps=1e4, seed=1234)

cd2_dem_2000 <- read_dta("Replication/NH2002,2002,2004Primaries/2-candidate races/cd2 dem 2000.dta")
cd2_dem_2000_1 <- lm(brannen ~ branord01 + totvoter, data = cd2_dem_2000)
ritest(cd2_dem_2000_1, 'branord01', reps=1e4, seed=1234)
cd2_dem_2000_2 <- lm(jackman ~ jackord01 + totvoter, data = cd2_dem_2000)
ritest(cd2_dem_2000_2, 'jackord01', reps=1e4, seed=1234)

cd2_dem_2002 <- read_dta("Replication/NH2002,2002,2004Primaries/2-candidate races/cd2 dem 2002.dta")
cd2_dem_2002_1 <- lm(jackman ~ jackord01 + totvoter, data = cd2_dem_2002)
ritest(cd2_dem_2002_1, 'branord01', reps=1e4, seed=1234)
cd2_dem_2002_2 <- lm(swett ~ swetord01 + totvoter, data = cd2_dem_2002)
ritest(cd2_dem_2002_2, 'swetord01', reps=1e4, seed=1234)

cd2_dem_2004 <- read_dta("Replication/NH2002,2002,2004Primaries/2-candidate races/cd2 dem 2004.dta")
cd2_dem_2004_1 <- lm(hodes ~ hodeord01 + totvoter, data = cd2_dem_2004)
ritest(cd2_dem_2004_1, 'hodeord01', reps=1e4, seed=1234)
cd2_dem_2004_2 <- lm(owen ~ owenord01 + totvoter, data = cd2_dem_2004)
ritest(cd2_dem_2004_2, 'owenord01', reps=1e4, seed=1234)

cd2_rep_2002 <- read_dta("Replication/NH2002,2002,2004Primaries/2-candidate races/cd2 rep 2002.dta")
cd2_rep_2002_1 <- lm(bass ~ bassord01 + totvoter, data = cd2_rep_2002)
ritest(cd2_rep_2002_1, 'bassord01', reps=1e4, seed=1234)
cd2_rep_2002_2 <- lm(douglass ~ dougord01 + totvoter, data = cd2_rep_2002)
ritest(cd2_rep_2002_2, 'dougord01', reps=1e4, seed=1234)

cd2_rep_2004 <- read_dta("Replication/NH2002,2002,2004Primaries/2-candidate races/cd2 rep 2004.dta")
cd2_rep_2004_1 <- lm(bass ~ bassord01 + totvoter, data = cd2_rep_2004)
ritest(cd2_rep_2004_1, 'bassord01', reps=1e4, seed=1234)
cd2_rep_2004_2 <- lm(brady ~ bradord01 + totvoter, data = cd2_rep_2004)
ritest(cd2_rep_2004_2, 'bradord01', reps=1e4, seed=1234)

gov_dem_2000 <- read_dta("Replication/NH2002,2002,2004Primaries/2-candidate races/gov dem 2000.dta")
gov_dem_2000_1 <- lm(fernald ~ fernord01 + totvoter, data = gov_dem_2000)
ritest(gov_dem_2000_1, 'fernord01', reps=1e4, seed=1234)
gov_dem_2000_2 <- lm(shaheen ~ shahord01 + totvoter, data = gov_dem_2000)
ritest(gov_dem_2000_2, 'shahord01', reps=1e4, seed=1234)

gov_dem_2002 <- read_dta("Replication/NH2002,2002,2004Primaries/2-candidate races/gov dem 2002.dta")
gov_dem_2002_1 <- lm(fernald ~ fernord01 + totvoter, data = gov_dem_2002)
ritest(gov_dem_2002_1, 'fernord01', reps=1e4, seed=1234)
gov_dem_2002_2 <- lm(hollingworth ~ hollord01 + totvoter, data = gov_dem_2002)
ritest(gov_dem_2002_2, 'hollord01', reps=1e4, seed=1234)

gov_dem_2004 <- read_dta("Replication/NH2002,2002,2004Primaries/2-candidate races/gov dem 2004.dta")
gov_dem_2004_1 <- lm(lynch ~ lyncord01 + totvoter, data = gov_dem_2004)
ritest(gov_dem_2004_1, 'lyncord01', reps=1e4, seed=1234)
gov_dem_2004_2 <- lm(mceachern ~ mceaord01 + totvoter, data = gov_dem_2004)
ritest(gov_dem_2004_2, 'mceaord01', reps=1e4, seed=1234)

gov_rep_2004 <- read_dta("Replication/NH2002,2002,2004Primaries/2-candidate races/gov rep 2004.dta")
gov_rep_2004_1 <- lm(benson ~ bensord01 + totvoter, data = gov_rep_2004)
ritest(gov_rep_2004_1, 'bensord01', reps=1e4, seed=1234)
gov_rep_2004_2 <- lm(tarbell ~ tarbord01 + totvoter, data = gov_rep_2004)
ritest(gov_rep_2004_2, 'tarbord01', reps=1e4, seed=1234)

# 3-candidate race (N=2)
# 2 * 3 = 6
sen_rep_2002 <- read_dta("Replication/NH2002,2002,2004Primaries/3-candidate races/sen rep 2002.dta")
sen_rep_2002_1 <- lm(smith ~ smitord1v23 + totvoter, data = sen_rep_2002)
ritest(sen_rep_2002_1, 'smitord1v23', reps=1e4, seed=1234)
sen_rep_2002_2 <- lm(stemsky ~ stemord1v23 + totvoter, data = sen_rep_2002)
ritest(sen_rep_2002_2, 'stemord1v23', reps=1e4, seed=1234)
sen_rep_2002_3 <- lm(sununu ~ sunuord1v23 + totvoter, data = sen_rep_2002)
ritest(sen_rep_2002_3, 'sunuord1v23', reps=1e4, seed=1234)

sen_rep_2004 <- read_dta("Replication/NH2002,2002,2004Primaries/3-candidate races/sen rep 2004.dta")
sen_rep_2004_1 <- lm(alciere ~ alciord1v23 + totvoter, data = sen_rep_2004)
ritest(sen_rep_2004_1, 'alciord1v23', reps=1e4, seed=1234)
sen_rep_2004_2 <- lm(gregg ~ gregord1v23 + totvoter, data = sen_rep_2004)
ritest(sen_rep_2004_2, 'gregord1v23', reps=1e4, seed=1234)
sen_rep_2004_3 <- lm(tipa ~ tipaord1v23 + totvoter, data = sen_rep_2004)
ritest(sen_rep_2004_3, 'tipaord1v23', reps=1e4, seed=1234)

# more than 3-candidate race (N=4)
# 4 + 8 + 5 + 6 = 23
cd1_dem_2004 <- read_dta("Replication/NH2002,2002,2004Primaries/greater than 3-candidate races/cd1 dem 2004.dta")
cd1_dem_2004_1 <- lm(bruce ~ brucord1velse + totvoter, data = cd1_dem_2004)
ritest(cd1_dem_2004_1, 'brucord1velse', reps=1e4, seed=1234)
cd1_dem_2004_2 <- lm(duffy ~ dufford1velse + totvoter, data = cd1_dem_2004)
ritest(cd1_dem_2004_2, 'dufford1velse', reps=1e4, seed=1234)
cd1_dem_2004_3 <- lm(liles ~ lileord1velse + totvoter, data = cd1_dem_2004)
ritest(cd1_dem_2004_3, 'lileord1velse', reps=1e4, seed=1234)
cd1_dem_2004_4 <- lm(nadeau ~ nadeord1velse + totvoter, data = cd1_dem_2004)
ritest(cd1_dem_2004_4, 'nadeord1velse', reps=1e4, seed=1234)

cd1_rep_2002 <- read_dta("Replication/NH2002,2002,2004Primaries/greater than 3-candidate races/cd1 rep 2002.dta")
cd1_rep_2002_1 <- lm(barrows ~ barrord1velse + totvoter, data = cd1_rep_2002)
ritest(cd1_rep_2002_1, 'barrord1velse', reps=1e4, seed=1234)
cd1_rep_2002_2 <- lm(bevill ~ beviord1velse + totvoter, data = cd1_rep_2002)
ritest(cd1_rep_2002_2, 'beviord1velse', reps=1e4, seed=1234)
cd1_rep_2002_3 <- lm(bradley ~ bradord1velse + totvoter, data = cd1_rep_2002)
ritest(cd1_rep_2002_3, 'bradord1velse', reps=1e4, seed=1234)
cd1_rep_2002_4 <- lm(clark ~ clarord1velse + totvoter, data = cd1_rep_2002)
ritest(cd1_rep_2002_4, 'clarord1velse', reps=1e4, seed=1234)
cd1_rep_2002_5 <- lm(hoffman ~ hofford1velse + totvoter, data = cd1_rep_2002)
ritest(cd1_rep_2002_5, 'hofford1velse', reps=1e4, seed=1234)
cd1_rep_2002_6 <- lm(mahoney ~ mahoord1velse + totvoter, data = cd1_rep_2002)
ritest(cd1_rep_2002_6, 'mahoord1velse', reps=1e4, seed=1234)
cd1_rep_2002_7 <- lm(stephen ~ stepord1velse + totvoter, data = cd1_rep_2002)
ritest(cd1_rep_2002_7, 'stepord1velse', reps=1e4, seed=1234)
cd1_rep_2002_8 <- lm(wendelboe ~ wendord1velse + totvoter, data = cd1_rep_2002)
ritest(cd1_rep_2002_8, 'wendord1velse', reps=1e4, seed=1234)

gov_rep_2000 <- read_dta("Replication/NH2002,2002,2004Primaries/greater than 3-candidate races/gov rep 2000.dta")
gov_rep_2000_1 <- lm(bramante ~ bramord1velse + totvoter, data = gov_rep_2000)
ritest(gov_rep_2000_1, 'bramord1velse', reps=1e4, seed=1234)
gov_rep_2000_2 <- lm(howard ~ howaord1velse + totvoter, data = gov_rep_2000)
ritest(gov_rep_2000_2, 'howaord1velse', reps=1e4, seed=1234)
gov_rep_2000_3 <- lm(humphrey ~ humpord1velse + totvoter, data = gov_rep_2000)
ritest(gov_rep_2000_3, 'humpord1velse', reps=1e4, seed=1234)
gov_rep_2000_4 <- lm(marron ~ marrord1velse + totvoter, data = gov_rep_2000)
ritest(gov_rep_2000_4, 'marrord1velse', reps=1e4, seed=1234)
gov_rep_2000_5 <- lm(squires ~ squiord1velse + totvoter, data = gov_rep_2000)
ritest(gov_rep_2000_5, 'squiord1velse', reps=1e4, seed=1234)

gov_rep_2002 <- read_dta("Replication/NH2002,2002,2004Primaries/greater than 3-candidate races/gov rep 2002.dta")
gov_rep_2002_1 <- lm(benson ~ bensord1velse + totvoter, data = gov_rep_2002)
ritest(gov_rep_2002_1, 'bensord1velse', reps=1e4, seed=1234)
gov_rep_2002_2 <- lm(hass ~ hassord1velse + totvoter, data = gov_rep_2002)
ritest(gov_rep_2002_2, 'hassord1velse', reps=1e4, seed=1234)
gov_rep_2002_3 <- lm(humphrey ~ humpord1velse + totvoter, data = gov_rep_2002)
ritest(gov_rep_2002_3, 'humpord1velse', reps=1e4, seed=1234)
gov_rep_2002_4 <- lm(keough ~ keouord1velse + totvoter, data = gov_rep_2002)
ritest(gov_rep_2002_4, 'keouord1velse', reps=1e4, seed=1234)
gov_rep_2002_5 <- lm(kingsbury ~ kingord1velse + totvoter, data = gov_rep_2002)
ritest(gov_rep_2002_5, 'kingord1velse', reps=1e4, seed=1234)
gov_rep_2002_6 <- lm(kroepel ~ kroeord1velse + totvoter, data = gov_rep_2002)
ritest(gov_rep_2002_6, 'kroeord1velse', reps=1e4, seed=1234)

# Total = 22 (2-candidate) + 6 (3-candidate) + 23 (3+candidate) = 51 analyses from primaries